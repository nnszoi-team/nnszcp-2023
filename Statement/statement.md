# Problem A. 欢迎光临

*时间限制：1 秒；空间限制：128 MiB。*

南宁市第三中学是广西首批重点中学、广西首批示范性高中、首批普通高中新课程新教材实施国家级示范校。学校前身为 1897 年维新人士余镜清创办的南宁乌龙寺讲堂。学校目前拥有青山校区、五象校区、初中部青秀校区、初中部五象校区、初中部江南校区等 5 个校区，形成多校区集团办学模式。历经 126 年办学历史的洗礼与积淀，南宁三中以「真 · 爱教育」的办学思想和「德育为先，文理并重，崇尚一流」的办学特色饮誉华夏大地，成为莘莘学子向往的求知殿堂。

为了欢迎各位新老选手的到来，南宁三中 01 社的成员们写了一句欢迎语。但是你作为一名新选手，不是很了解夹杂在欢迎语中的各种梗，你只知道 `nnsz` 是「南宁三中」的意思。

聪明的你想知道，在欢迎语中，是否存在一段连续部分（即子串）为 `nnsz`。

## 输入格式

给定一个仅包含小写英文字母且不包含空格的字符串 $ S $，代表欢迎语。

## 输出格式

如果欢迎语 $ S $ 存在一段连续部分（即子串）为 `nnsz`，输出 `YES`，否则输出 `NO`。

**答案不区分大小写**。例如，当答案为 `YES` 时，`yes`，`yEs`，`YEs` 等答案均可被判定为正确答案。

## 样例 1

### 样例 1 输入

```
welcometonnsz
```

### 样例 2 输出

```
YES
```

## 样例 2

### 样例 2 输入

```
nnez
```

### 样例 2 输出

```
NO
```

## 样例 3

### 样例 3 输入

```
nocommander
```

### 样例 3 输出

```
NO
```

## 数据范围

记 $ n $ 为 $ S $ 的长度。

对于 $ 100\% $ 的数据，保证：

* $ 1 \le n \le 100 $；
* $ S $ 中仅包含小写英文字母。

## 子任务

0. （45 分）$ n \le 3 $；
1. （5 分）$ n = 4 $；
2. （50 分）无额外限制。

# Problem B. 反应原理

*时间限制：1 秒；空间限制：128 MiB。*

你说的对，但是《化学》是由化学家自主研发的一款全新开放世界冒险游戏。故事发生在一个被称作「微观状态」的架空世界，在这里，被选中的原子将被授予「电子」，导引键能之力。

你将扮演一位名为「臭写题的」的神秘角色，在自由的刷题中邂逅性质各异、能力独特的化合物们，和他们一起击败强题，找回失散的离子——同时，逐步发掘「元素周期表」的真相。

---

小 P 和小 Q 是同桌。这天，化学老师在课上让他们回答活化能的定义。

化学老师说：「一个化学反应由多个反应步骤依次进行完成。已知某反应共有 $n$ 个反应步骤，初始时物质的总能量为 $a_0$，定义第 $i$ 个反应步骤后，物质的总能量为 $a_i$。」

小 P 说：「化学反应的活化能是某个反应步骤进行前后，总能量**变化量**的**最大值**。即 $\max_{i=0}^{n-1} \{a_{i + 1} - a_{i}\}$。」

小 Q 说：「化学反应的活化能是整个化学反应进程中的能量的**最大值**，即 $\max_{i=0}^{n} \{a_i\}$。」

显然两人的回答都不正确。但化学老师还是给了你一个化学反应，并请你分别求出在两人眼里，这个反应的活化能是多少？

**注意本题中物质的能量可能为负值**。

## 输入格式

第一行一个正整数 $n$，含义见题目描述。

接下来一行 $n + 1$ 个整数，第 $i$ 个整数代表 $a_{i - 1}$。

## 输出格式

第一行包含一个整数，表示在小 P 眼里，这个反应的活化能。

第二行包含一个整数，表示在小 Q 眼里，这个反应的活化能。

## 样例 1

### 样例 1 输入

```
4
1 4 6 10 12
```

### 样例 1 输出

```
12
4
```

## 样例 2

### 样例 2 输入

```
4
31 12 23 13 -21
```

### 样例 2 输出

```
31
11
```

## 提示

#### 样例 1 解释

在小 P 眼里，这个反应的活化能为 $\max\{1, 4, 6, 10, 12\} = 12$。

在小 Q 眼里，这个反应的活化能为 $\max\{4-1, 6-4, 10-6, 12-10\} = 4$。

## 数据范围

对 $100\%$ 的数据，保证：

* $1 \le n \le 3 \times {10}^5$；
* $-{10}^7 \le a_i \le {10}^7$；
* 所有输入数据都是整数。

## 子任务

0. （25 分）$2 \le n \le 10^3$；
1. （25 分）对 $0 \le i < n$，$a_i \le a_{i+1}$；
2. （50 分）无额外限制。

# Problem C. 暮光闪闪

*时间限制：2 秒；空间限制：256 MiB。*

<img src=".\assets\twilight.jpg" alt="twilight" style="zoom: 25%;" />


小马利亚要建造一批新的建筑，公主暮光闪闪一共计划了 $ n $ 栋建筑物，每一栋建筑物的高度为 $ h_i $。现在，作为该工程的领导者，云宝希望城市的规划能够为天马们提供一些便利。

这些建筑将有 $ m $ 匹天马入住。对于第 $ i $ 匹天马，其飞行的高度为 $ s_i $。

天马们彼此都很熟识，它们经常相互串门，在建筑之间穿梭。云宝认为：如果一对**不同**的建筑物高度差的绝对值不大于这匹天马的飞行高度，那么这匹天马就能在这对建筑之间穿梭。具体地，若对于第 $i$ 匹天马和一对不同的建筑物 $\left(u, v\right)$（$ u \neq v $），这匹天马能在这对建筑物之间穿梭，当且仅当 $| h_u - h_v | \le s_i$。

云宝想知道：每一匹天马最多能够在多少对**不同**的建筑之间穿梭？由于工期紧张，她需要你的帮助，因此请你帮忙解决这个问题。

这里的一对建筑物 $\left(u, v\right)$ 是**无序的**，也就是说认为 $\left(u, v\right)$ 和 $\left(v, u\right)$ 是完全等价的。 

## 输入格式

第一行两个正整数 $ n, m $。

第二行 $ n $ 个正整数，代表 $ h_1, h_2, h_3, \dots, h_n $。

第三行 $ m $ 个正整数，代表 $ s_1, s_2, s_3, \dots, s_m $。

## 输出格式

一共 $ m $ 行，每行一个整数，代表答案。

## 样例 1

### 样例 1 输入

```
3 2
1 2 3
1 2
```

### 样例 1 输出

```
2
3
```

## 提示

#### 样例 1 解释

对于 $ s_1 = 1 $ 的天马，它最多可以在建筑 $ 1 $ 与建筑 $ 2 $、建筑 $ 2 $ 与建筑 $3$ 之间穿梭。

对于 $ s_2 = 2 $ 的天马，它最多可以在建筑 $ 1 $ 与建筑 $ 2 $、建筑 $ 1 $ 与建筑 $ 3 $、建筑 $ 2 $ 与建筑 $ 3 $ 之间穿梭。

## 数据范围

对于 $ 100\% $ 的数据，保证：

* $ 1 \le m \le 10^5$；
* $1 \le n \le 2 \times 10^3 $；
* $1 \le h_i, s_i \le {10}^9$；
* 所有输入数据都是正整数。

## 子任务

0. （20 分）$ 1 \le m \le 100 $，$ 1 \le n \le 100 $；
1. （10 分）所有的 $h_i$ 都相等；
2. （70 分）无额外限制。

# Problem D. 中考录取

*时间限制：1 秒；空间限制：128 MiB。*

N 市某年的初中学业考试和高中阶段学校招生考试成绩排名规则如下：

考生需经历语文、数学、英语、物理、化学、道德与法治和历史（以下简称“政史”）共 $ 6 $ 门文化课考试，以及体育考试。

考生在每门考试中都有对应的原始分（为简便起见，我们认为**原始分都是整数**），我们设考生 $ i $ 的原始分为

- 语文原始分为 $a_i$；
- 数学原始分为 $b_i$；
- 英语原始分为 $c_i$；
- 物理原始分为 $d_i$；
- 化学原始分为 $e_i$；
- 政史原始分为 $f_i$；
- 体育原始分为 $g_i$；
- 总原始分为 $ s_i = a_i + b_i + c_i + d_i + e_i + f_i + g_i$。

对于语文原始分、数学原始分、英语原始分、物理原始分、化学原始分、政史原始分和总原始分共 $ 7 $ 项数据，每项数据都被**从高到低**划分成 $ \texttt{A+} $，$ \texttt{A} $，$ \texttt{B+} $，$ \texttt{B} $，$ \texttt{C+} $，$ \texttt{C} $，$ \texttt{D} $，$ \texttt{E} $ 共 $ 8 $ 种等级，但为问题简便起见，我们认为**等级只有 $ \texttt{A+} $ 与 $ \texttt{A} $ 共 $ 2 $ 种**。

对于每一项数据，教育部门划定了一条分数线 $ l $。以语文学科为例，设教育部门为语文学科划定的分数线为 $ l_a $，则对于考生 $ i $，有：

- 当 $ a_i < l_a $ 时，考生 $ i $ 的语文等级为 $ \texttt{A} $；
- 当 $ a_i \ge l_a $ 时，考生 $ i $ 的语文等级为 $ \texttt{A+} $；
- 其他科目的对应等级以同样方式评定。

在对每个考生的原始分划分等级后，两名考生的等级组合将按如下规则比较：

- 两名考生中**总分**等级更高的一名的成绩更优；
- 若两名考生的总分等级相同，则两名考生中 $ \texttt{A+} $ 等级的**数量**更多的一名的成绩更优；
- 若两名考生的 $ \texttt{A+} $ 等级的数量仍相同，则**语文**等级更高的一名的成绩更优；
- 若两名考生的语文等级仍相同，则**数学**等级更高的一名的成绩更优；
- 若两名考生的数学等级仍相同，则**英语**等级更高的一名的成绩更优；
- 若两名考生的英语等级仍相同，则**物理**等级更高的一名的成绩更优；
- 若两名考生的物理等级仍相同，则**化学**等级更高的一名的成绩更优；
- 若两名考生的化学等级仍相同，则**政史**等级更高的一名的成绩更优；
- 若两名考生的政史等级仍相同，则直接认为两名考生的成绩**完全相同**，没有优劣之分。（尽管两人的原始分可能不完全相同）

ZSNN 作为 N 市的一所重点高中，是众多优秀学子所向往的学府。自然，想要进入 ZSNN，就要经过激烈的竞争。

该年报考 ZSNN 的考生共有 $ n $ 名，而 ZSNN 拟录取的新生人数为 $ m $ 人。而教育部门规定，**成绩组合完全相同的人，其报考结果（即录取与否）也应该相同**。这导致了实际录取人数 $ m^\prime $ 与拟录取人数 $ m $ 可能略有出入。

现在，给出 $ n $ 和 $ m $，以及 $ n $ 名考生的所有原始分数据，和各个科目的分数线。请你求出在保证 $ m^\prime \ge m $ 的情况下 $ m^\prime $ 的**最小值**。

## 输入格式

第一行包含 $ 7 $ 个整数 $ l_a, l_b, l_c, l_d, l_e, l_f, l_s $，分别代表语文、数学、英语、物理、化学、政史和总分的分数线。

第二行包含 $ 2 $ 个整数 $ n, m \left(m \le n\right) $，分别代表报考 ZSNN 的考生总数和 ZSNN 拟录取的新生人数。

接下来的 $ n $ 行中的第 $ i $ 行包含 $ 7 $ 个整数 $ a_i, b_i, c_i, d_i, e_i, f_i, g_i $，分别代表考生 $ i $ 的语文、数学、英语、物理、化学、政史、体育原始分。

## 输出格式

输出一个整数 $ m^\prime $，代表实际录取的新生人数。

## 样例 1

### 样例 1 输入

```
105 106 117 93 97 118 640
2 1
110 113 119 95 98 119 60
105 106 117 93 97 118 36
```

### 样例 1 输出

```
2
```

## 样例 2

### 样例 2 输入

```
105 106 117 93 97 118 640
2 1
100 106 115 92 95 114 57
104 105 116 93 96 117 60
```

### 样例 2 输出

```
1
```

## 样例 3

### 样例 3 输入

```
105 106 117 93 97 118 640
2 1
104 105 116 92 96 117 60
120 120 120 100 100 0 60
```

### 样例 3 输出

```
1
```

## 样例 4

### 样例 4 输入

```
81 55 33 22 84 5 180 
10 3
26 45 51 65 60 1 2 
105 69 18 40 24 40 4 
54 44 9 85 10 114 11 
41 62 69 82 98 52 53 
109 78 88 24 91 60 13 
103 99 11 73 53 66 0 
69 104 63 45 38 92 17 
43 119 75 94 6 119 33 
76 101 50 12 8 70 51 
54 48 21 79 73 27 25
```

### 样例 4 输出

```
4
```

## 提示

### 样例 1 解释

考生 $ 1 $ 与考生 $ 2 $ 的等级组合均为「总分 $ \texttt{A+} $ 和 $ \texttt{6A+} $」，他们应该同时被录取。

### 样例 2 解释

考生 $ 1 $ 与考生 $ 2 $ 的等级组合均为「总分 $ \texttt{A+} $ 和 $ \texttt{1A+5A} $」，但在两人语文等级相同的情况下，考生 $ 1 $ 的数学等级高于 $ 2 $ 考生 $ 2 $ 的数学等级。故考生 $ 1 $ 的成绩更优秀，只有考生 $ 1 $ 能被录取。

### 样例 3 解释

考生 $ 1 $ 的总分等级为 $ \texttt{A+} $，而考生 $ 2 $ 的总分等级为 $ \texttt{A} $。故考生 $ 1 $ 的成绩更优秀，只有考生 $ 1 $ 能被录取。

## 数据范围

对于 $ 100\% $ 的数据，保证：

* $ 1 \le m \le n \le 10^5 $；
* $ 0 \le a_i, l_a \le 120 $；
* $ 0 \le b_i, l_b \le 120 $；
* $ 0 \le c_i, l_c \le 120 $；
* $ 0 \le d_i, l_d \le 100 $；
* $ 0 \le e_i, l_e \le 100 $；
* $ 0 \le f_i, l_f \le 120 $；
* $ 0 \le g_i \le 60 $；
* $ 0 \le l_s \le 740 $；
* 所有输入数据均为整数。

## 子任务

0. （20 分）$1 \le m \le n \le 10$，且所有人的等级组合均不相同；
1. （80 分）无额外限制。

# Problem E. 填数游戏

*时间限制：1 秒；空间限制：128 MiB。*

<img src=".\assets\game.jpg" alt="game" style="zoom: 25%;" />

二等咒器技官威廉坐在房间的书桌前，天蓝色中夹杂些许红色的长发，面带微笑的妖精少女珂朵莉侍立在旁。烛火轻轻摇曳，若明若暗的光轻轻落在珂朵莉忽明忽暗的脸颊上。珂朵莉明显有一点点紧张，她无处安放的双手有些不安的藏在背后，纠缠在一起，眼神时不时的装作不经意的模样瞟向窗外。

这几天珂朵莉一直闷闷不乐，威廉很担忧，于是他突发奇想。

“让我们来玩一个游戏吧！”

珂朵莉首先说出一个正整数 $k$。

“那就 $68$ 吧，”珂朵莉随即说，“毕竟这里是 $68$ 号岛。”

接着威廉画出了一个 $5\times 5$ 的矩阵。

珂朵莉依次选了一些数（如下图）。每次选出一个数并将其画上圈，再把它所在行和列的其他数划掉，表示这些数都不可以选。不断重复直到所有数都已经被选过或不可以选为止。

<img src=".\assets\game_sample.png" style="zoom: 33%;" />

经过珂朵莉的验证，发现不管怎么选，最后把画上圈的数加起来，它肯定等于 $68$ 。

珂朵莉一脸惊讶地问威廉是怎么做到的，可威廉却偏偏卖关子：“明天再告诉你。”

好奇心胜的珂朵莉完全等不住，于是找到了聪明的你，希望你能复现这个游戏，并跟她一起研究其中的奥秘。

**珂朵莉把这个游戏形式化地描述给你：**

给定两个正整数 $n, k$。你需要**构造**一个 $n\times n$ 的矩阵 $A$，其中 $A_{i,j}$ 是**不重复**的整数且 $A_{i,j}\in[0,k]$，使得其满足：

- 任意选出的不在同行同列的 $n$ 个元素之和为 $k$。

对每组数据，给出一个解或报告无解。

## 输入格式

第一行一个正整数 $T$，表示数据组数。

下面的 $T$ 行，每行两个正整数 $n, k$。

## 输出格式

输出共 $T$ 组，分别表示每组测试数据的答案。

对于每组测试数据，如果该组测试数据有解，输出 $n$ 行，每行 $n$ 个由空格隔开的整数，第 $i$ 行第 $j$ 个数表示 $A_{i,j}$，否则仅输出一行一个整数 $-1$ 代表无解。

## 样例 1

### 样例 1 输入

```
1
5 68
```

### 样例 1 输出

```
7 9 8 6 10
18 20 19 17 21
13 15 14 12 16
1 3 2 0 4
24 26 25 23 27
```

## 样例 2

### 样例 2 输入

```
1
6 60
```

### 样例 2 输出

```
-1
```

## 提示

样例 1 的解释见题目描述。

## 数据范围

对于 $ 100\% $ 的数据，保证：

* $1\leq T\leq 10$；
* $1\leq n\leq 500$；
* $1\leq k\leq 10^9$。
* 所有输入数据均为正整数。

## 子任务

0. （10 分）$T = 1$，$n = 1$；
1. （15 分）$T = 1$，$1 \le n \le 5$，$1 \le k \le 100$；
2. （25 分）$1 \le n \le 100$，$1 \le k \le 10^5$；
3. （50 分）无额外限制。

# Problem F. 初生几何

*时间限制：2 秒；空间限制：128 MiB。*

<img src=".\assets\mathematics.png" alt="mathematics" style="zoom: 20%;" />

如图，在平面直角坐标系中，抛物线 $ y = x(k - x) $ 与直线 $ y = -1 $ 相交。抛物线与 $ x $ 轴的另一个交点为 $\mathrm{A}$。设**线段** $\mathrm{OA}$ 上存在一动点 $\mathrm{P}$，过点 $\mathrm{P}$ 作 $y$ 轴的平行线交抛物线于点 $\mathrm{B}$，交直线 $y = -1$ 于点 $\mathrm{C}$。试求 $\mathrm{OB}^2 + \mathrm{AC}^2$ 的最大值。

## 输入格式

每个测试点包含多组测试数据。

每个测试点的第一行包含一个整数 $ T $，代表测试数据组数。

接下来的 $ T $ 行，每行包含两个正整数 $ a, b $，表示 $ k = \dfrac{a}{b} $。

## 输出格式

对于每组测试数据，输出一个**实数**，代表 $\mathrm{OB}^2 + \mathrm{AC}^2$ 的最大值。

设你的答案为 $ x $，标准答案为 $ X $，则绝对误差 $ \Delta x = \left| X - x \right| $，相对误差 $ E_r = \dfrac{\Delta x}{X} $。

当 $ \Delta x \le 10^{-5} $ 或 $ E_r \le 10^{-5} $ 时，你的答案即可被判定为正确答案。

## 样例 1

### 样例 1 输入

```
3
365 254
10000 1
1 10000
```

### 样例 1 输出

```
3.064991629983
625000050000001.000000000000
1.000000010000
```

## 提示

### 样例 1 解释

对于第一组数据，能够证明 $\mathrm{OB}^2 + \mathrm{AC}^2 \le \dfrac{197741}{64516} \approx 3.064991629983$。

## 数据范围

对于 $ 100\% $ 的数据，保证：

* $ 1 \le T \le 10^5$；
* $ 0 < a, b \le 10^4 $；
* 所有输入数据均为正整数。

## 子任务

0. （20 分）$b = 1$；
1. （80 分）无额外限制。

# Problem G. 排序算法

*时间限制：2 秒；空间限制：256 MiB。*

某日，小 C 翻出了不知多久以前写的老代码，内容如下：

```cpp
#include <iostream>
#include <vector>

int main() {
    int n;
    std::cin >> n;
    std::vector<int> a(n);
    for (int i = 0; i < n; ++i) {
        std::cin >> a[i];
    }

    for (int i = 0; i < n; ++i) {
        for (int j = 0; j < n; ++j) {
            if (a[i] < a[j]) {
                std::swap(a[i], a[j]);
            }
        }
    }

    for (int i = 0; i < n; ++i) {
        std::cout << a[i] << " \n"[i == n - 1];
    }

    return 0;
}
```

小 C 非常困惑，他想知道他的程序是否正确，并且想知道：`std::swap(a[i], a[j]);` 执行了多少次。

形式化地说：给定正整数 $ n $ 与一个长度为 $ n $ 的序列 $ a $，如果题目背景中的程序可以将序列 $ a $ 排序为**严格不下降**序列，则输出 `YES`，并输出程序中 `std::swap(a[i], a[j]);` 这一条语句的运行次数，否则输出 `NO`。



## 输入格式

每个测试点的输入数据包括两行，第一行包含一个正整数 $ n $，第二行包含 $ n $ 个由空格隔开的正整数 $ a_0, a_1, \dots, a_{n-1} $。

## 输出格式

如果程序可以将序列 $ a $ 重新排序为**严格不下降**序列，则在第一行输出 `YES`，并在第二行输出一个整数，代表程序中 `std::swap(a[i], a[j]);` 这一条语句的运行次数，否则输出 `NO`。

## 样例 1

### 样例 1 输入

```
5
5 4 3 2 1
```

### 样例 1 输出

```
YES
10
```

## 数据范围

对于 $100\%$ 的数据，保证：

* $ 1 \le n \le 2 \times 10^5$；
* $1 \le a_i \le 10^9 $;
* 所有输入数据均为正整数。

## 子任务

0. （20 分）$1 \le n \le 10^3$；
1. （30 分）所有的 $a_i$ 均不相等。
2. （50 分）无额外限制。

# Problem H. 购买车券

*时间限制：2 秒；空间限制：256 MiB。*

<img src=".\assets\sparkarte.jpg" alt="sparkarte" style="zoom: 25%;" />


力量来自欢乐是 1930 年代德国的一个旅游公司，他们在本土推出了一款汽车，由费迪南德·保时捷一手设计，其宗旨是让每一个德国人民都用得上一辆汽车。为了促进德国人民购买力量来自欢乐牌汽车，德国政府推出了一种购车券：每一张券的价值是 5 帝国马克，购买的人可以通过类似集邮的方式，当其所拥有的券价值总和和一辆车同价（990 帝国马克）时，就能够兑换一辆力量来自欢乐牌汽车。然而，和梅福券一样，随着 1939 年战争的爆发，大部分的购车券都成为了空头支票，被政府用作了扩军的资本。

在探究课前，小 K 正在研究有关的历史，所以他收集了 $n$ 张购车券，并假设某些购车券之间有一定的关联关系。现在发现购车券之间一共有 $n - 1$ 对**双向的**关联关系，并且这些购车券**不存在**循环的关联关系（即关联关系不成环）。

对于一张购车券，当 小 K **至多**未购买一张和其相关联的购车券时，他就可以购买该购车券。当小 K 购买了所有的购车券时，他便能够兑换一辆力量来自欢乐牌汽车。

小 K 想请你帮他计算：有多少种购买购车券的方案，使得小 K 能够兑换一辆汽车。由于答案可能很大，小 K 只想知道其对 $998244353$ 取模的结果。

## 输入格式

第一行一个正整数 $n$，含义见题目描述。

接下来 $n-1$ 行，每行两个正整数 $u_i,v_i$，表示第 $u_i$ 张和第 $v_i$ 张购车券之间有一对关联关系。

## 输出格式

共一行，包含一个整数，为购买购车券的方案数对 $998244353$ 取模的值。

## 样例 1

### 样例 1 输入

```
3
1 2
1 3
```

### 样例 1 输出

```
4
```

## 样例 2

### 样例 2 输入

```
5
1 2
1 3
2 4
2 5
```

### 样例 2 输出

```
28
```

## 样例 3

### 样例 3 输入

```
8
1 2
1 3
3 4
4 5
4 6
6 7
7 8
```

### 样例 3 输出

```
392
```

## 样例 4

### 样例 4 输入

```
18
14 3
16 11
6 10
8 7
1 3
4 17
3 17
4 16
9 13
15 10
13 2
18 9
17 12
12 10
7 5
3 18
7 12
```

### 样例 4 输出

```
289685999
```

## 提示

### 样例 1 解释

<img src=".\assets\sparkarte_sample.png" alt="sparkarte_sample" style="zoom: 33%;" />

小 K 可以先购买 $3$ 号购车券，此时对于 $1$ 号购车券，他只剩一张关联的购车券还未拥有（$2$ 号购车券），因此他能够购买 $1$ 号购车券。总共的购买顺序为 $(3, 1, 2)$。类似的，他也能以 $(2, 1, 3)$，$(2, 3, 1)$，$(3, 2, 1)$ 的顺序购买，一共 $4$ 种购买方式。

## 数据范围

对于 $ 100\% $ 的数据，保证：

* $1 \le n \le 10^5 $；
* $1 \le u_i, v_i \le n$；
* $u_i \neq v_i$；
* $\left( u_i, v_i \right) \neq \left( u_j, v_j \right)$；
* 所有输入数据均为正整数。

## 子任务

0. （13 分）$1 \le n \le 10$；
1. （21 分）$1 \le n \le 10^3$；
2. （12 分）每张购车券至多只有两张购车券相关联。
3. （12 分）存在至少一张购车券与 $n-1$ 张购车券相关联。
4. （42 分）无额外限制。

# Problem I. 花腔星云

*时间限制：2 秒；空间限制：256 MiB。*

<img src="./assets/coloratura.jpg" alt="coloratura" style="zoom: 25%;" />

And up there in the heavens 高高在上 于天堂之中

Galileo and those pining for the moon 伽利略和前人们伫立于此

Know it's a slow burn 深知过程必然缓慢

Through Pioneer and Helix 掠过先驱者号与螺旋星云

Oumuamua, Heliopause, and Neptune 奥陌陌，日球层顶与海王星

We're a slow-burning tune 韵律缓慢燃烧

But we'll get there 故事延绵亘久

—— Coloratura 花腔星云，Coldplay

---

小 L 透过望远镜看到了一片花腔星云。

在这个宇宙一共有 $3$ 种行星，其种类编号分别为 $1, 2, 3$，而这片星云有 $n$ 颗行星，第 $i$ 颗行星的种类编号为 $a_i$。

为了采集数据，小 L 从 $q$ 种观察角度观察了这片星云。第 $i$ 种观察角度及结果用一个三元组 $\left(l_i, r_i, v_i\right)$ 表示，代表第 $l_i$ 颗至第 $r_i$ 颗行星的种类编号的乘积除以 $4$ 的余数为 $v_i$，即：
$$
\left(\prod_{j=l_i}^{r_i} a_j\right) \bmod 4 = v_i
$$
现在小 L 将他的记录数据告诉了你，你能不能猜出星云中的每颗行星可能的种类呢？

小 L 观察得很认真，所以记录一定没有出错，也就是说存在一种每颗行星种类的情况，满足小 L 的所有观察得到的结果。

## 输入格式

第一行两个整数 $n, q$，含义见题目描述。

接下来 $q$ 行，每行三个整数 $l_i, r_i, v_i$，代表给定的三元组。

## 输出格式

输出 $n$ 个正整数，代表一个满足条件的序列 $a_j$。

你可以输出**任意**满足条件的序列。

## 样例 1

### 样例 1 输入

```
6 3
1 3 3
2 4 2
5 6 1
```

### 样例 1 输出

```
3 1 1 2 3 3
```

## 样例 2

### 样例 2 输入

```
11 4
1 3 2
3 6 2
5 9 2
3 6 2
10 11 0
```

### 样例 2 输出

```
2 1 3 2 1 3 2 1 3 2 2
```

## 提示

### 样例 1 解释

第一种观察角度 $\left(1, 3, 3\right)$ 即 $\left(3 \times 1 \times 1\right) \bmod 4 = 3$。

第二个观察角度 $\left(2, 4, 2\right)$ 即 $\left(1 \times 1 \times 2\right) \bmod 4 = 2$。

第三个观察角度 $\left(5, 6, 1\right)$ 即 $\left(3 \times 3\right) \bmod 4 = 1$。

据此，所有的观察角度都得到了满足，$3, 1, 1, 2, 3, 3$ 是一组合法解。

## 数据范围

对于 $100\%$ 的数据，保证：

* $1 \le n \le 2 \times {10}^4$；
* $0 \le q \le 2 \times {10}^4$；
* $1 \le l_i \le r_i \le n$；
* $0 \le v_i < 4$；
* 存在一种序列 $a_j$，能够满足所有的 $(l_i, r_i, v_i)$；
* 所有输入数据均为整数。

## 子任务

0. （2 分）$q = 0$；
1. （13 分）$1 \le n, q \le 10$；
2. （17 分）$1 \le n, q \le 10^2$，所有的 $v_i$ 均为 $2$；
3. （27 分）$1 \le n, q \le {10}^3$，所有的 $v_i$ 均为 $1$ 或 $3$；
4. （41 分）无额外限制。

# Problem J. 繁星满天

*时间限制：2 秒；空间限制：256 MiB。*

<img src="./assets/starry.jpg" style="zoom:30%;" />

小 E 躺在草地上抬头看天空，想要看星星。天空可以视为一个位于第一象限、边界的一部分在 $x, y$ 轴正半轴上的正方形网格，大小是 $p \times p$。

形式化地，网格的四个顶点分别是 $(0, 0)$、$(0, p)$、$(p, p)$、$(p, 0)$，边界为折线 $(0, 0) \rightsquigarrow (0, p) \rightsquigarrow (p, p) \rightsquigarrow (p, 0) \rightsquigarrow (0, 0)$。

突然，小 E 获得了一种能够释放星星的超能力。具体地，每次小 E 发动超能力，他可以选择下面两种做法其中之一来释放一颗星星：

1. 选择一个**整点**（横纵坐标都是整数的点），在该点释放一颗星星；

2. 选择两对**已经存在**的星星，在这两对星星的连线交点处释放一颗星星。

   **注意这个点可以不是整点**。


由于小 E 需要精确控制星星以组成图案，所以**每次释放的星星都必须在网格内部或边界上。**

小 E 想让这片天空看上去不那么单调，所以他选择了一个点 $\left( \frac{a}{b}, \frac{c}{d} \right)$（这个点的横纵坐标不大于 $1$），想在上面释放一颗星星。为了尽快达成目标，他想得到一个发动超能力的方案，使得在他发动超能力**至多 $1500$ 次**以后，点 $\left( \frac{a}{b}, \frac{c}{d} \right)$ 上面有一颗星星。

小 E 还要花时间调配星星的色彩，看起来这个任务就交给你了。

## 输入格式

一行五个正整数 $p, a, b, c, d$，含义见题目描述。

## 输出格式

第一行一个正整数 $n$，代表小 E 需要发动超能力的次数。**你需要保证 $1 \le n \le 1500$**。

接下来 $n$ 行，第 $i$ 行有三个或五个整数，第一个整数应当为 $1$ 或 $2$：

* 若第一个整数为 $1$，即代表小 E 将在一个整点上释放一颗星星。接下来应当有两个整数 $x, y$，你需要保证 $0 \le x, y \le p$。

* 若第一个整数为 $2$，即代表小 E 将在某两对星星的连线交点处释放一颗星星。接下来应当有四个正整数 $s, t, u, v$，你需要保证 $1 \le s, t, u, v < i$，并且第 $s, t$ 次发动超能力得到星星的连线，与第 $u, v$ 次发动超能力得到星星的连线相交，同时得到交点的坐标 $x, y$ 满足 $0 \le x, y \le p$。

**如果有多个满足条件的方案，你可以输出任意一个。**

## 样例 1

### 样例 1 输入

```
2 1 1 1 1
```

### 样例 1 输出

```
1
1 1 1
```

## 提示

为了方便实现，我们下发了一份 `fraction.hpp`，这份程序实现了一个分数类。你可以将其内容复制到你的程序中。

## 数据范围

设 $t = \max(b, d)$。对 $100\%$ 的数据，保证：

* $1 \le a \le b \le {10}^7$；
* $1 \le c \le d \le {10}^7$；
* $1 \le t \le 10^7$；
* $2 \le p \le {10}^7$；
* 所有输入数据均为正整数。

## 子任务

0. （10 分）$1 \le t \le {10}^3$，$p \ge {10}^7$；
1. （13 分）$1 \le t \le {10}^6$，$p \ge t + 1$；
2. （21 分）$p \ge \lceil \frac{t}{2} \rceil + 1$；
3. （25 分）$p \ge \lceil \sqrt t \rceil + 2$；
4. （31 分）无额外限制。
