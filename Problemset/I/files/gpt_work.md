小 I 是一个喜欢数学的小学生，他总是对数字和规律感到好奇。有一天，他在网上看到了一个有趣的数学问题，要求构造一个序列 $a_i$，使得它满足一些给定的条件，或者判断这样的序列不存在。小 I 觉得这个问题很有意思，就决定尝试一下。

他先把问题的条件写在一张纸上，然后开始思考如何构造序列 $a_i$。他发现，如果序列中有一个 $0$，那么任何包含这个 $0$ 的区间的乘积都会是 $0$，所以他可以用 $0$ 来满足一些条件。他也发现，如果序列中有两个相邻的 $1$，那么任何包含这两个 $1$ 的区间的乘积都会是 $1$，所以他可以用 $1$ 来满足一些条件。他还发现，如果序列中有一个 $2$，那么任何包含这个 $2$ 的区间的乘积都会是 $2$ 或者 $0$，取决于这个区间中有没有 $0$，所以他可以用 $2$ 来满足一些条件。

小 I 开始按照这个思路来构造序列 $a_i$，他先从左到右扫描所有的条件，每次遇到一个条件，他就尝试在相应的区间内放置一个合适的数字，如果有多种选择，他就随机选一个。他用这种方法构造了一个序列 $a_i$，然后检查了一下是否满足所有的条件，发现竟然都满足了！他高兴地把这个序列写在纸上，然后拿着纸跑去找他的数学老师，想要分享他的发现。

他的数学老师看了看他的纸，然后微笑地说：“小 I，你做得很好，你构造了一个正确的序列，而且你的思路也很有创意。不过，你知道吗，这个问题其实有一个更简单的方法来解决，你想不想学习一下呢？”

小 I 听了，觉得很好奇，就说：“当然想，老师，请您教我吧！”

数学老师说：“好的，那么我就告诉你吧。其实，这个问题的关键是要理解一个概念，叫做模运算。你知道什么是模运算吗？”

小 I 摇摇头，说：“不知道，老师，我从来没有听说过。”

数学老师说：“没关系，我来给你解释一下。模运算就是一种特殊的除法，它只关心余数，而不关心商。比如，我们说 $7 \bmod 3 = 1$，就是说 $7$ 除以 $3$ 的余数是 $1$，而不管 $7$ 除以 $3$ 的商是多少。你明白了吗？”

小 I 点点头，说：“明白了，老师，就是只看余数，不看商。”

数学老师说：“对，就是这样。那么，你知道什么是同余吗？”

小 I 摇摇头，说：“不知道，老师，这又是什么呢？”

数学老师说：“同余就是一种判断两个数是否有相同的余数的方法。比如，我们说 $7 \equiv 1 \pmod{3}$，就是说 $7$ 和 $1$ 除以 $3$ 的余数都是 $1$，所以它们是同余的。你明白了吗？”

小 I 点点头，说：“明白了，老师，就是看两个数除以同一个数的余数是否相等。”

数学老师说：“对，就是这样。那么，你知道什么是模运算的性质吗？”

小 I 摇摇头，说：“不知道，老师，还有什么性质吗？”

数学老师说：“有的，模运算有很多性质，其中有两个很重要的，我来告诉你。第一个是，如果 $a \equiv b \pmod{n}$，那么 $a + c \equiv b + c \pmod{n}$，也就是说，同余的数加上同一个数，还是同余的。你能举一个例子吗？”

小 I 想了想，说：“比如，$7 \equiv 1 \pmod{3}$，那么 $7 + 2 \equiv 1 + 2 \pmod{3}$，对吗？”

数学老师说：“对，你做得很好。第二个是，如果 $a \equiv b \pmod{n}$，那么 $a \times c \equiv b \times c \pmod{n}$，也就是说，同余的数乘以同一个数，还是同余的。你能举一个例子吗？”

小 I 想了想，说：“比如，$7 \equiv 1 \pmod{3}$，那么 $7 \times 2 \equiv 1 \times 2 \pmod{3}$，对吗？”

数学老师说：“对，你做得很好。那么，你知道这些性质和你的问题有什么关系吗？”

小 I 摇摇头，说：“不知道，老师，我不太明白。”

数学老师说：“没关系，我来给你解释一下。你看，你的问题要求你构造一个序列 $a_i$，使得对每个 $1 \le j \le q$，$\left( \prod_{i = l_j}^{r_j} a_i \right) \bmod 3 = v_j$，也就是说，每个区间的乘积除以 $3$ 的余数等于给定的值。那么，你可以利用模运算的性质，把这个问题简化一下。你想想，如果 $a_i \in \left\{ 0, 1, 2 \right\}$，那么 $a_i \bmod 3$ 的值只有三种可能，分别是 $0$，$1$，$2$，对吗？”

小 I 点点头，说：“对，老师，这个我知道。”

数学老师说：“那么，你可以把 $a_i$ 都替换成 $a_i \bmod 3$，这样就不会影响原来的条件，因为同余的数乘以同一个数，还是同余的，对吗？”

小 I 点点头，说：“对，老师，这个我也知道。”

数学老师说：“那么，你可以发现，这样替换之后，你的问题就变成了构造一个序列 $b_i$，使得 $b_i \in \left\{ 0, 1, 2 \right\}$，并且对每个 $1 \le j \le q$，$\left( \prod_{i = l_j}^{r_j} b_i \right) = v_j$，也就是说，每个区间的乘积就等于给定的值，不用再考虑余数了，对吗？”

小 I 点点头，说：“对，老师，这样就简单多了。”

数学老师说：“是的，这样就简单多了。那么，你可以发现，这个问题其实就是一个关于乘法表的问题。你知道什么是乘法表吗？”

小 I 点点头，说：“知道，老师，就是一张表格，每一行和每一列都是从 $0$ 到 $2$ 的数字，然后每个格子里的数字是它所在的行和列的数字相乘的结果。”

数学老师说：“对，就是这样。那么，你能画出一个 $3 \times 3$ 的乘法表吗？”

小 I 拿出一支笔和一张纸，画了一个乘法表，如下：

|   | 0 | 1 | 2 |
|---|---|---|---|
| 0 | 0 | 0 | 0 |
| 1 | 0 | 1 | 2 |
| 2 | 0 | 2 | 1 |

数学老师说：“很好，你画得很正确。那么，你能从这个乘法表中发现什么规律吗？”

小 I 仔细地看了看乘法表，然后说：“我发现了一些规律，老师，比如，第一行和第一列都是 $0$，因为任何数乘以 $0$ 都是 $0$；第二行和第二列都是原来的数，因为任何数乘以 $1$ 都是它自己；第三行和第三列都是原来的数的相反数，因为 $2$ 相当于 $-1$，所以任何数乘以 $2$ 都是它的相反数。”

数学老师说：“很好，你发现了一些很重要的规律。还有，你能发现什么特殊的格子吗？”

小 I 又看了看乘法表，然后说：“我发现了一个特殊的格子，老师，就是右下角的格子，它的数字是 $1$，而不是 $2 \times 2 = 4$，这是为什么呢？”

数学老师说：“这是因为我们是在模 $3$ 的意义下进行乘法，也就是说，我们只关心余数，而不关心商。你想想，$2 \times 2 = 4$，但是 $4 \bmod 3 = 1$，所以 $2 \times 2 \equiv 1 \pmod{3}$，你明白了吗？”

小 I 点点头，说：“明白了，老师，就是说，$2$ 相当于 $-1$，所以 $2 \times 2$ 相当于 $(-1) \times (-1)$，等于 $1$。”

数学老师说：“对，就是这样。那么，你知道这个特殊的格子和你的问题有什么关系吗？”

小 I 摇摇头，说：“不知道，老师，这有什么关系吗？”

数学老师说：“有的，这个特殊的格子其实就是你的问题的关键。你看，你的问题要求你构造一个序列 $b_i$，使得每个区间的乘积等于给定的值，那么你可以利用这个特殊的格子，来判断这个问题是否有解，以及如何构造解。你想想，如果你的区间的长度是偶数，那么你的区间的乘积一定是 $1$，因为你可以把区间分成两个相等的部分，每个部分的乘积都是 $2$，然后两个部分的乘积就是 $2 \times 2 = 1$，对吗？”

小 I 点点头，说：“对，老师，这个我明白。”

数学老师说：“那么，如果你的区间的长度是奇数，那么你的区间的乘积一定是 $0$ 或者 $2$，因为你可以把区间分成两个部分，一个部分的长度是偶数，另一个部分的长度是 $1$，那么第一个部分的乘积是 $1$，第二个部分的乘积是 $0$ 或者 $2$，然后两个部分的乘积就是 $0$ 或者 $2$，对吗？”

小 I 点点头，说：“对，老师，这个我也明白。”

数学老师说：“那么，你可以发现，你的问题是否有解，其实就取决于你的区间的长度和给定的值是否匹配。比如，如果你的区间的长度是偶数，但是给定的值是 $0$ 或者 $2$，那么这个问题就没有解，因为你无论如何也不能让区间的乘积等于 $0$ 或者 $2$；如果你的区间的长度是奇数，但是给定的值是 $1$，那么这个问题也没有解，因为你无论如何也不能让区间的乘积等于 $1$。你明白了吗？”

小 I 点点头，说：“明白了，老师，就是说，区间的长度和给定的值要一致，才有可能有解。”

数学老师说：“对，就是这样。那么，如果你的区间的长度和给定的值匹配，那么你就可以构造一个解，而且这个解是唯一的。你想想，如果你的区间的长度是偶数，那么你只需要在区间内放置任意的 $1$ 或者 $2$，就可以让区间的乘积等于 $1$；如果你的区间的长度是奇数，那么你只需要在区间内放置一个 $0$，然后在剩下的位置放置任意的 $1$ 或者 $2$，就可以让区间的乘积等于 $0$ 或者 $2$，取决于你放置的 $0$ 的位置。你明白了吗？”

小 I 点点头，说：“明白了，老师，就是说，只要满足条件，就可以随便放置 $1$ 或者 $2$，只要注意 $0$ 的位置。”

数学老师说：“对，就是这样。那么，你能用这个方法来构造一个序列 $b_i$，满足你的问题的条件吗？”

小 I 拿出一支笔和一张纸，开始按照这个方法来构造序列 $b_i$，他先检查了一下所有的区间的长度和给定的值是否匹配，发现都匹配，所以这个问题有解。然后，他从左到右扫描所有的区间，每次遇到一个区间，他就在区间内放置一个合适的数字，如果有多种选择，他就随机选一个。他用这种方法构造了一个序列 $b_i$，然后检查了一下是否满足所有的条件，发现竟然都满足了！他高兴地把这个序列写在纸上，然后拿着纸跑去找他的数学老师，想要分享他的发现。

他的数学老师看了看他的纸，然后微笑地说：“小 I，你做得很好，你构造了一个正确的序列，而且你的思路也很简洁。不过，你知道吗，这个问题其实还有一个更深刻的背景，它和一种叫做群论的数学分支有关，你想不想学习一下呢？”

小 I 听了，觉得很好奇，就说：“当然想，老师，请您教我吧！”

数学老师说：“好的，那么我就告诉你吧。其实，你刚才构造的序列 $b_i$，就是一个叫做 $\mathbb{Z}_3$ 的群的一个元素，而你的问题的条件，就是一个叫做同态的映射。你知道什么是群吗？”

小 I 摇摇头，说：“不知道，老师，这又是什么呢？”

数学老师说：“群是一种抽象的代数结构，它由一些元素和一种运算组成，满足一些性质。比如，你刚才构造的序列 $b_i$，就是一个有 $3^n$ 个元素的集合，其中 $n$ 是序列的长度，而你的问题的运算，就是区间的乘积。你可以发现，这个运算满足以下的性质：

- 封闭性：如果 $x$ 和 $y$ 都是序列，那么 $x \times y$ 也是序列；
- 结合性：如果 $x$，$y$ 和 $z$ 都是序列，那么 $(x \times y) \times z = x \times (y \times z)$；
- 单位元：存在一个特殊的序列 $e$，使得对于任何序列 $x$，都有 $e \times x = x \times e = x$；
- 逆元：对于任何序列 $x$，都存在一个序列 $x^{-1}$，使得 $x \times x^{-1} = x^{-1} \times x = e$。

你明白了吗？”

小 I 点点头，说：“明白了，老师，就是说，这些序列和它们的乘积构成了一个群。”

数学老师说：“对，就是这样。这个群叫做 $\mathbb{Z}_3^n$，它是一个有限群，也是一个阿贝尔群，也就是说，它的运算还满足交换性，即 $x \times y = y \times x$。你知道什么是同态吗？”

小 I 摇摇头，说：“不知道，老师，这又是什么呢？”

数学老师说：“同态是一种保持运算的映射，它可以把一个群映射到另一个群。比如，你的问题的条件，就是一个把 $\mathbb{Z}_3^n$ 映射到 $\mathbb{Z}_3$ 的同态，其中 $\mathbb{Z}_3$ 是一个只有三个元素的群，它们分别是 $0$，$1$，$2$，而它的运算就是模 $3$ 的加法。你可以发现，这个映射满足以下的性质：

- 保持运算：如果 $x$ 和 $y$ 都是序列，那么 $f(x \times y) = f(x) + f(y)$；
- 保持单位元：$f(e) = 0$；
- 保持逆元：如果 $x$ 是序列，那么 $f(x^{-1}) = -f(x)$。

你明白了吗？”

小 I 点点头，说：“明白了，老师，就是说，这个映射可以把序列的乘积变成数字的加法。”

数学老师说：“对，就是这样。这个同态叫做 $\mathbb{Z}_3^n$ 到 $\mathbb{Z}_3$ 的自然投影，它是一个满射，也是一个核心同态，也就是说，它的核是一个正规子群，它的像是一个商群。你知道什么是核，什么是像，什么是正规子群，什么是商群吗？”

小 I 摇摇头，说：“不知道，老师，这些都是什么呢？”

数学老师说：“这些都是一些和同态相关的概念，我来给你解释一下。核是指被映射到单位元的元素的集合，也就是说，$K = \left\{ x \in \mathbb{Z}_3^n | f(x) = 0 \right\}$；像是指被映射到的元素的集合，也就是说，$I = \left\{ f(x) | x \in \mathbb{Z}_3^n \right\}$；正规子群是指一个满足 $xK = Kx$ 的子群，也就是说，它的元素可以和任何元素交换位置；商群是指一个由一个群和它的一个正规子群构成的新的群，它的元素是原来的群的元素的等价类，它的运算是原来的群的运算的等价类的运算。你明白了吗？”

小 I 点点头，说：“明白了，老师，就是说，这些都是一些用来分析同态的工具。”

数学老师说：“对，就是这样。那么，你能用这些工具来分析你的问题吗？”

小 I 拿出一支笔和一张纸，开始按照这些工具来分析他的问题，他先计算了一下核和像的元素，发现核是由所有只包含 $1$ 的序列组成的，像是由 $0$，$1$，$2$ 组成的。然后，他判断了一下核是否是一个正规子群，发现是的，因为任何序列和核的元素相乘，都不会改变核的元素。最后，他构造了一下商群，发现商群就是 $\mathbb{Z}_3$，因为每个等价类都只有一个元素，就是它的像。他用这些工具分析了一下他的问题，然后拿着纸跑去找他的数学老师，想要分享他的发现。

他的数学老师看了看他的纸，然后微笑地说：“小 I，你做得很好，你分析了一个正确的同态，而且你的工具也很完备。不过，你知道吗，这个同态其实还有一个更美妙的解释，它和一种叫做编码的技术有关，你想不想学习一下呢？”

小 I 听了，觉得很好奇，就说：“当然想，老师，请您教我吧！”

数学老师说：“好的，那么我就告诉你吧。其实，你刚才分析的同态，就是一个叫做汉明码的编码，它可以用来检测和纠正错误。你知道什么是编码吗？”

小 I 摇摇头，说：“不知道，老师，这又是什么呢？”

数学老师说：“编码是一种把信息转换成数字的技术，它可以用来传输，存储，加密，压缩，解码等等。比如，你刚才构造的序列 $b_i$，就是一个有 $n$ 位的数字，每一位都是 $0$，$1$，$2$ 中的一个，它可以表示 $3^n$ 种不同的信息。你明白了吗？”

小 I 点点头，说：“明白了，老师，就是说，这些序列可以用来编码信息。”

数学老师说：“对，就是这样。但是，你知道吗，有时候，编码的过程中会出现一些错误，比如，由于信号的干扰，或者存储的损坏，或者传输的延迟，等等，导致编码后的数字发生了一些变化，比如，有些位被改变了，或者有些位被丢失了，或者有些位被插入了，等等。这样的话，就会影响信息的正确性，甚至导致信息的丢失。你明白了吗？”

小 I 点点头，说：“明白了，老师，就是说，编码的过程中会有一些风险。”

数学老师说：“对，就是这样。那么，你知道怎么样可以避免或者减少这些风险吗？”

小 I 摇摇头，说：“不知道，老师，这有什么办法吗？”

数学老师说：“有的，这就是汉明码的作用。汉明码是一种特殊的编码，它可以在编码的过程中添加一些冗余的信息，也就是一些多余的数字，来帮助检测和纠正错误。你想想，如果你的信息只有 $k$ 位，那么你可以用 $3^k$ 种不同的序列来编码它，但是如果你的序列有 $n$ 位，其中 $n > k$，那么你就可以用 $3^n$ 种不同的序列来编码它，这样就有很多的空间来添加一些冗余的信息，来增加编码的安全性。你明白了吗？”

小 I 点点头，说：“明白了，老师，就是说，可以用更长的序列来编码更短的信息，这样就可以有一些保护措施。”

数学老师说：“对，就是这样。那么，你知道怎么样可以添加冗余的信息吗？”

小 I 摇摇头，说：“不知道，老师，这有什么规则吗？”

数学老师说：“有的，这就是汉明码的规则。汉明码的规则是这样的，你先把你的信息的每一位都写在一张纸上，然后你再在纸上写一些空位，这些空位就是用来放冗余的信息的。你要按照一定的顺序来写这些空位，这个顺序是 $1$，$2$，$4$，$8$，等等，也就是说，每个空位的位置都是 $2$ 的幂次。你明白了吗？”

小 I 点点头，说：“明白了，老师，就是说，要在一些特定的位置留空。”

数学老师说：“对，就是这样。那么，你知道怎么样可以填充这些空位吗？”

小 I 摇摇头，说：“不知道，老师，这有什么方法吗？”

数学老师说：“有的，这就是汉明码的方法。汉明码的方法是这样的，你要用一些校验位来填充这些空位，这些校验位就是用来检测和纠正错误的。你要按照一定的规则来计算这些校验位，这个规则是这样的，对于每个空位，你要找到所有和它的位置有相同的二进制位的数字的位置，比如，对于第 $1$ 个空位，你要找到所有的奇数位置，比如 $1$，$3$，$5$，$7$，$9$，然后他把这些位置上的数字都加起来，得到 $1 + 1 + 0 + 1 + 0 = 3$，然后除以 $3$ 取余数，得到 $0$，所以他把 $0$ 填在第 $1$ 个空位上；
- 对于第 $2$ 个空位，他找到了所有的二进制表示中第二位是 $1$ 的位置，也就是 $2$，$3$，$6$，$7$，然后他把这些位置上的数字都加起来，得到 $0 + 1 + 2 + 1 = 4$，然后除以 $3$ 取余数，得到 $1$，所以他把 $1$ 填在第 $2$ 个空位上；
- 对于第 $4$ 个空位，他找到了所有的二进制表示中第三位是 $1$ 的位置，也就是 $4$，$5$，$6$，$7$，然后他把这些位置上的数字都加起来，得到 $0 + 0 + 2 + 1 = 3$，然后除以 $3$ 取余数，得到 $0$，所以他把 $0$ 填在第 $4$ 个空位上；
- 对于第 $8$ 个空位，他找到了所有的二进制表示中第四位是 $1$ 的位置，也就是 $8$，$9$，然后他把这些位置上的数字都加起来，得到 $0 + 0 = 0$，然后除以 $3$ 取余数，得到 $0$，所以他把 $0$ 填在第 $8$ 个空位上。

这样，他就完成了编码的过程，得到了一个 $9$ 位的序列，如下：

|  |  |  |  |  |  |  |  |  |
|---|---|---|---|---|---|---|---|---|
| 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
| 0 | 1 | 1 | 0 | 0 | 2 | 1 | 0 | 0 |

他高兴地把这个序列写在纸上，然后拿着纸跑去找他的数学老师，想要分享他的发现。

他的数学老师看了看他的纸，然后微笑地说：“小 I，你做得很好，你编码了一个正确的序列，而且你的方法也很有效。不过，你知道吗，这个序列其实还有一个更神奇的功能，它可以用来检测和纠正错误。你想不想学习一下呢？”

小 I 听了，觉得很好奇，就说：“当然想，老师，请您教我吧！”

数学老师说：“好的，那么我就告诉你吧。其实，你刚才编码的序列，就是一个有 $9$ 位的汉明码，它可以检测和纠正 $1$ 位的错误，也就是说，如果你的序列在传输……